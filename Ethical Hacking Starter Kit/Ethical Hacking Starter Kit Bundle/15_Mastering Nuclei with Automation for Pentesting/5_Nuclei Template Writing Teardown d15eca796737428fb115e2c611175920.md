# 5_Nuclei Template Writing Teardown

# Nuclei Header

- Headers can be defined using headers:
- They are placed in key-value format
- Ex: `User-Agent: Some-Random-User-Agent`

```yaml
id: nuclei-headers-block

info:
	name: Nuclei Headers Block 
	author: hacktifycs 
	severity: info
	tags: panel, headers, nuclei 
	description: Write your description here 
	reference: https://hacktify.in/

requests:
	- method: GET
	 path:
			- '{{BaseURL}}'

#The below is what we are focusing 
	headers:
		User-Agent: Hacktify
		X-Forwaded-Host: hacktify.in
		Cache-Control: no-transform
		Test-Header: hello-world
```

# Nuclei Body

- body: specifies the request body to be sent
- They are placed in key-value format
- Ex: body: "admin=test"
- To maintain sessions, we can reuse the cookies by cookie-reuse: true

```yaml
id: Nuclei-Body-Block

info:
	name: Nuclei Body Block 
	author: hacktifycs 
	severity: info
	tags: panel, body, nuclei 
	description: Write your description here 
	reference: https://hacktify.in/

requests:
	- method: GET 
		path:
			- '{{BaseURL}}'

		body: "search=apple"
```

This is a Nuclei template writing block that specifies the request body to be sent. The block has an ID of "Nuclei-Body-Block" and contains information on the name, author, severity, tags, description, and reference for the block. The request method is GET, and the path is set to `{{BaseURL}}`. The body of the request is set to "search=apple".

# Nuclei Raw Request

- In RAW requests, requests can be modified
- Raw Requests can be defined using raw:
- RAW requests supports various helper functions
- Helper functions help in manipulation of the input in the different requests

A Nuclei raw request allows for the modification of requests using the `raw` field. This field supports various helper functions that can help manipulate the input in different requests.

```yaml
id: Nuclei-Raw-Request-Block

info:
	name: Nuclei Raw Request Block
	author: hacktifycs
	severity: info
	tags: panel, raw, nuclei
	description: Write your description here
	reference: <https://hacktify.in/>

requests:
	- raw: 
		- |
				POST/post/HTTP/1.1
				Host: {{BaseURL}}
				User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36
				search=Apple 

```

The above Nuclei block is a raw request that has an ID of "Nuclei-Raw-Request-Block". It contains information on the name, author, severity, tags, description, and reference for the block. The request method is POST and the raw request includes the Host and User-Agent headers.

# Nuclei Unsafe Raw Request

- These are used for complete control & customisation
- Allows any kind of malformed requests
- Helpful for bugs like CRLF, HTTP Request Smuggling
- We can enable it using:
    
                              unsafe:true
    

```yaml
id: Nuclei-Raw-Request-Block

info:
	name: Nuclei Raw Request Block 
	author: hacktifycs 
	severity: info
	tags: panel, info, nuclei 
	description: Write your description here 
	reference: https://hacktify.in/

requests:
	- raw:
		- | 
				POST /post/ HTTP/2
				Host: {{Hostname}}
				Content-Type: application/x-www-form-urlencoded
				Hacktify-Header: Hacktify-Unsafe-HTTP
				search=Apple
	unsafe: true
```

This is a Nuclei template block with the ID "Nuclei-Raw-Request-Block". It is an example of an unsafe raw request that allows for complete control and customization of the request. The request method is POST and the raw request includes the Host, Content-Type, and Hacktify-Header headers. The body of the request is set to "search=Apple". The "unsafe" field is set to "true" to enable the unsafe raw request. The block has information on the name, author, severity, tags, description, and reference for the block.

# Nuclei GET Matcher Body

- Get Based Matcher Body

```yaml
id: Nuclei-GET-Matcher-Body

info:
    name: Nuclei GET Matcher Body
    author: hacktifycs
    severity: info
    tags: panel, matching, nuclei
    description: Write your description here
    reference: <https://hacktify.in/>

requests:
    - method: GET
      path:
          - '<https://example.com/users/{{user_id}>}'
      matchers:
          - type: word
            words:
                - 'example'
          - type: status
            status:
                - 200
          - type: equals
            part: body
            value: 'Hello World!'

```

The above is a Nuclei code template for the GET Matcher Body with the ID "Nuclei-GET-Matcher-Body". It contains information on the name, author, severity, tags, description, and reference for the block. The request method is GET and the path includes a placeholder for the user ID. The matchers include a word matcher for the word "example", a status matcher for a 200 status code, and an equals matcher for the response body to match the value "Hello World!".

# Nuclei GET Matcher Body

- Get Based Matcher Header

```yaml
id: Nuclei-GET-Matcher-Header

info:
    name: Nuclei GET Matcher Header
    author: hacktifycs
    severity: info
    tags: panel, matching, nuclei
    description: Write your description here
    reference: <https://hacktify.in/>

requests:
    - method: GET
      path:
          - '{{BaseURL}}'
      headers:
          User-Agent: Mozilla
      matchers:
          - type: word
            words:
                - 'example'
          - type: status
            status:
                - 200
          - type: equals
            part: header
            value:
                Server: Apache

```

This is a Nuclei code template for the GET Matcher Header with the ID "Nuclei-GET-Matcher-Header". It contains information on the name, author, severity, tags, description, and reference for the block. The request method is GET and the path is set to `{{BaseURL}}`. The User-Agent header is set to Mozilla. The matchers include a word matcher for the word "example", a status matcher for a 200 status code, and an equals matcher for the response header to match the value "Server: Apache".