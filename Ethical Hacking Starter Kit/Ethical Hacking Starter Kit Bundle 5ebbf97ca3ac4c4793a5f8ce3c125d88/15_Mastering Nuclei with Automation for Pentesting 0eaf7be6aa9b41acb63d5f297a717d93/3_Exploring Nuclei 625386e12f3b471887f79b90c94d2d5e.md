# 3_Exploring Nuclei

# Nuclei Debug

### `nuclei -u "<url>" - nuclei-templates/technologies/nginx/nginx-version.yaml -debug -v`

This is a command to run a security scanner called Nuclei with the `nginx-version.yaml` template. It checks the version of the Nginx web server running on the specified URL. The `-debug` flag enables debugging mode, and `-v` enables verbose mode.

# YAML Lint PHP Template

How to modify a template. Make the below template to php detector

```yaml
id: nginx-version

info:
  name: Nginx version detect
  author: philippedelteil,daffainfo
  severity: info
  description: Some nginx servers have the version on the response header. Useful when you need to find specific CVEs on your targets.
  tags: tech,nginx
  metadata:
    max-request: 1

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    matchers-condition: and
    matchers:
      - type: regex
        part: header
        regex:
          - 'nginx/[0-9.]+'

      - type: status
        status:
          - 200

    extractors:
      - type: regex
        part: header
        regex:
          - 'nginx/[0-9.]+'
```

```yaml
id: PHP-version

info:
  name: PHP version detect
  author: philippedelteil,daffainfo
  severity: info
  description: Some nginx servers have the version on the response header. Useful when you need to find specific CVEs on your targets.
  tags: tech,nginx
  metadata:
    max-request: 1

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    matchers-condition: and
    matchers:
      - type: regex
        part: header
        regex:
          - 'PHP/[0-9.]+'

      - type: status
        status:
          - 200

    extractors:
      - type: regex
        part: header
        regex:
          - 'PHP/[0-9.]+'
```

- Check the modified file at [https://www.yamllint.com/](https://www.yamllint.com/)
- Run the nuclei using new template

# Nuclei Filters

- `-tags`: This flag allows you to add tags to the Nuclei scan. You can add multiple tags by separating them with commas. For example, `tags web,vuln` will add the "web" and "vuln" tags to the scan.
- `-severity`: This flag allows you to set the severity level for the Nuclei scan. The available options are "info", "low", "medium", and "high". For example, `severity medium` will set the severity level to "medium".
- `-author`: This flag allows you to filter the Nuclei scan by author. You can specify the author's name after the flag. For example, `author philippedelteil` will filter the scan by the author "philippedelteil".

# Nuclei Rete Limiting Flags

- `rate-limit`: Controls number of requests per second
- `bulk-size`: Controls number of parallel hosts
- `c`: Controls number of concurrent templates

## Rete limit

```
RATE-LIMIT:
   -rl, -rate-limit int               maximum number of requests to send per second (default 150)
   -rlm, -rate-limit-minute int       maximum number of requests to send per minute
   -bs, -bulk-size int                maximum number of hosts to be analyzed in parallel per template (default 25)
   -c, -concurrency int               maximum number of templates to be executed in parallel (default 25)
   -hbs, -headless-bulk-size int      maximum number of headless hosts to be analyzed in parallel per template (default 10)
   -headc, -headless-concurrency int  maximum number of headless templates to be executed in parallel (default 10)
```

# Nuclei HTTP Traffic Tagging

- Many programs asks hunters to set custom traffic
- You can set custom traffic using the flag `-H` or `-header`
- Nuclei `-header 'User-Agent: Mozilla - Hacktify'`

### Point

*HTTP traffic tagging is a technique used in ethical hacking where custom tags are added to the HTTP traffic. These tags can be used to identify and track the source of the traffic, and to distinguish it from other traffic. This can be useful for tracking down vulnerabilities and attacks, and for monitoring the behavior of systems and applications. In Nuclei, custom traffic can be set using the `-H` or `-header` flag. For example, `nuclei -u "<url>" -H 'User-Agent: Mozilla - Hacktify'` will set the user agent to "Mozilla - Hacktify".*

### [Request Catcher](https://requestcatcher.com/)

Request Catcher is a tool that captures and examines HTTP requests sent by your application or third-party services. It can be installed on your own server or used through a hosted version provided by the developers. It is useful for troubleshooting, debugging, and analyzing the behavior of third-party services.

# Nuclei Excluding Templates

To save time and resources, use `-exclude-templates` to exclude templates with a specific tag, `-etags` to exclude templates with a specific tag, and `-es` to exclude templates with a specific severity level in Nuclei.

- Exclude Templates: `-exclude-templates`
- Exclude Tags: `-etags`
- Exclude Severity: `-es`

# Nuclei Config File Creation

- Config file helps in configuration of what nuclei can do
- Default Path: $HOME/.config/nuclei/config.yaml
- Running nuclei with config: -config configuration.yam